<script type="text/javascript">
  var params = {};
  params.play = "false";
  params.loop = "false";
  params.menu = "false";
  params.allowfullscreen = "true";
  params.allowscriptaccess = "always";
  params.bgcolor = "#000000"
  params.wmode = "opaque";
  
  flashvars = {
    image: '<%=j current_user.template_picture.url %>'
  }
swfobject.embedSWF("<%= @template.effect_file.url + "?r=#{rand}" %>", "effect", "100%", "100%", "10.1.0", "<%= asset_path('expressInstall.swf')%>", flashvars, params);
</script>
<style>
  body {
    overflow: hidden;
  }
</style>
<div id="effect">

</div>
<div id="effectControls">
  <div class="topControls">
    <span class="balloon" style="left: 50%; top: -50px" data-timing="3,5">Drag to change the effect amount</span>
    <div id="effectAmount"></div>
    <input type="button" value="OK" class="submit" onclick="submitPage(); return false;">
  </div>
  <div id="templates">
    <table width="<%= @templates.size * 95 %>">
      <tr>
  <% @templates.each do |t| 
        is_current = @template.id == t.id ? 'selected' : ''
      %>
        <td><%= link_to image_tag(t.preview_url(:small), :class => is_current), :template => t.id %></td>
  <% end %>
      </tr>
    </table>
  </div>
</div>

<div id="wait">
  <%= image_tag "wait.png" %>
</div>

<script type="text/javascript">
  window.effectAmountValue = 0.5; <%=current_user.effect_amount%>;
</script>
