<script type="text/javascript">
  var params = {};
  params.play = "false";
  params.loop = "false";
  params.menu = "false";
  params.allowfullscreen = "true";
  params.allowscriptaccess = "always";
  params.bgcolor = "#000000"
  params.wmode = "opaque";
  
  flashvars = {
    image: '<%=j current_user.template_picture.url %>',
    text: "<%=j current_user.template_text %>",
    text_title: "<%=j current_user.template_title %>",
    text_id: '<%= current_user.template_text_id %>'
  }
swfobject.embedSWF("<%= @template.effect_file.url %>", "effect", "100%", "100%", "10.1.0", "<%= asset_path('expressInstall.swf')%>", flashvars, params);
function test(){
  console.log("hello")
}
</script>
<div id="effect">

</div>
<div id="effectControls">
  <div class="jslider" id="effectAmount"></div>
  <div id="templates">
  <% @templates.each do |t| 
        is_current = @template.id == t.id ? 'selected' : ''
  %>
  <%= link_to image_tag(t.preview_url(:small), :class => is_current), :template => t.id %>
  <% end %>
  </div>
  <div id="textTemplates">
    <% 10.times do |i|
        is_current = i == current_user.template_text_id
    %>
    <%= link_to_function image_tag("text_#{i}.jpg"), "$('#effect')[0].setTextLayout(#{i})" %>
    <%end%>
  </div>
  <div class="colorpicker"></div>
</div>

<script type="text/javascript">
  window.effectAmountValue = <%=current_user.effect_amount%>;
</script>
